from processing_py import *
import urllib.request, json

# API URLs
url_centro_so2 = 'http://datos.zaragoza.es/sparql?default-graph-uri=&query=PREFIX+ssn%3A%3Chttp%3A%2F%2Fpurl.oclc.org%2FNET%2Fssnx%2Fssn%23%3EPREFIX+dul%3A%3Chttp%3A%2F%2Fwww.loa-cnr.it%2Fontologies%2FDUL.owl%23%3EPREFIX+ssnext%3A%3Chttp%3A%2F%2Fvocab.linkeddata.es%2Fdatosabiertos%2Fdef%2Fmedio-ambiente%2Fcalidad-aire%2Fssn-ext%23%3Eselect+distinct+%3Fmagnitud+%3Festacion+%3Ffecha+%3Fvalor+%3Fverif+where+%7B%3Furi+a+ssn%3AObservation%3Bssn%3AobservedBy+%3Festacion%3Bssn%3AobservationResult+%3Fres%3Bssn%3AobservedProperty+%3Fmagnitud%3Bssnext%3AobservationStatus+%3Fverif%3Bssn%3AobservationResultTime+%3Ffecha.%3Fres+ssn%3AhasValue%2Fdul%3AhasDataValue+%3Fvalor.+filter++%28%3Ffecha%3E%3D%222021-10-02T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+%3Ffecha%3C%222021-10-03T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+regex%28%3Furi%2C+%22horaria%22%29+and+%3Festacion%3D%3Chttp%3A%2F%2Fwww.zaragoza.es%2Fapi%2Frecurso%2Fmedio-ambiente%2Fcalidad-aire%2Festacion%2F38%3E+and+%3Fmagnitud%3D%3Chttp%3A%2F%2Fes.dbpedia.org%2Fresource%2FDi%25C3%25B3xido_de_azufre%3E%29%7Dorder+by+%3Fmagnitud+%3Festacion+%3Ffecha&format=application%2Fsparql-results%2Bjson&timeout=0&debug=on'
url_centro_no2 = 'http://datos.zaragoza.es/sparql?default-graph-uri=&query=PREFIX+ssn%3A%3Chttp%3A%2F%2Fpurl.oclc.org%2FNET%2Fssnx%2Fssn%23%3EPREFIX+dul%3A%3Chttp%3A%2F%2Fwww.loa-cnr.it%2Fontologies%2FDUL.owl%23%3EPREFIX+ssnext%3A%3Chttp%3A%2F%2Fvocab.linkeddata.es%2Fdatosabiertos%2Fdef%2Fmedio-ambiente%2Fcalidad-aire%2Fssn-ext%23%3Eselect+distinct+%3Fmagnitud+%3Festacion+%3Ffecha+%3Fvalor+%3Fverif+where+%7B%3Furi+a+ssn%3AObservation%3Bssn%3AobservedBy+%3Festacion%3Bssn%3AobservationResult+%3Fres%3Bssn%3AobservedProperty+%3Fmagnitud%3Bssnext%3AobservationStatus+%3Fverif%3Bssn%3AobservationResultTime+%3Ffecha.%3Fres+ssn%3AhasValue%2Fdul%3AhasDataValue+%3Fvalor.+filter++%28%3Ffecha%3E%3D%222021-10-02T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+%3Ffecha%3C%222021-10-03T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+regex%28%3Furi%2C+%22horaria%22%29+and+%3Festacion%3D%3Chttp%3A%2F%2Fwww.zaragoza.es%2Fapi%2Frecurso%2Fmedio-ambiente%2Fcalidad-aire%2Festacion%2F38%3E+and+%3Fmagnitud%3D%3Chttp%3A%2F%2Fes.dbpedia.org%2Fresource%2FDi%25C3%25B3xido_de_nitr%25C3%25B3geno%3E%29%7Dorder+by+%3Fmagnitud+%3Festacion+%3Ffecha&format=application%2Fsparql-results%2Bjson&timeout=0&debug=on'
url_centro_co = 'http://datos.zaragoza.es/sparql?default-graph-uri=&query=PREFIX+ssn%3A%3Chttp%3A%2F%2Fpurl.oclc.org%2FNET%2Fssnx%2Fssn%23%3EPREFIX+dul%3A%3Chttp%3A%2F%2Fwww.loa-cnr.it%2Fontologies%2FDUL.owl%23%3EPREFIX+ssnext%3A%3Chttp%3A%2F%2Fvocab.linkeddata.es%2Fdatosabiertos%2Fdef%2Fmedio-ambiente%2Fcalidad-aire%2Fssn-ext%23%3Eselect+distinct+%3Fmagnitud+%3Festacion+%3Ffecha+%3Fvalor+%3Fverif+where+%7B%3Furi+a+ssn%3AObservation%3Bssn%3AobservedBy+%3Festacion%3Bssn%3AobservationResult+%3Fres%3Bssn%3AobservedProperty+%3Fmagnitud%3Bssnext%3AobservationStatus+%3Fverif%3Bssn%3AobservationResultTime+%3Ffecha.%3Fres+ssn%3AhasValue%2Fdul%3AhasDataValue+%3Fvalor.+filter++%28%3Ffecha%3E%3D%222021-10-02T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+%3Ffecha%3C%222021-10-03T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+regex%28%3Furi%2C+%22horaria%22%29+and+%3Festacion%3D%3Chttp%3A%2F%2Fwww.zaragoza.es%2Fapi%2Frecurso%2Fmedio-ambiente%2Fcalidad-aire%2Festacion%2F38%3E+and+%3Fmagnitud%3D%3Chttp%3A%2F%2Fes.dbpedia.org%2Fresource%2FMon%25C3%25B3xido_de_carbono%3E%29%7Dorder+by+%3Fmagnitud+%3Festacion+%3Ffecha&format=application%2Fsparql-results%2Bjson&timeout=0&debug=on'
url_actur_no2 = 'http://datos.zaragoza.es/sparql?default-graph-uri=&query=PREFIX+ssn%3A%3Chttp%3A%2F%2Fpurl.oclc.org%2FNET%2Fssnx%2Fssn%23%3EPREFIX+dul%3A%3Chttp%3A%2F%2Fwww.loa-cnr.it%2Fontologies%2FDUL.owl%23%3EPREFIX+ssnext%3A%3Chttp%3A%2F%2Fvocab.linkeddata.es%2Fdatosabiertos%2Fdef%2Fmedio-ambiente%2Fcalidad-aire%2Fssn-ext%23%3Eselect+distinct+%3Fmagnitud+%3Festacion+%3Ffecha+%3Fvalor+%3Fverif+where+%7B%3Furi+a+ssn%3AObservation%3Bssn%3AobservedBy+%3Festacion%3Bssn%3AobservationResult+%3Fres%3Bssn%3AobservedProperty+%3Fmagnitud%3Bssnext%3AobservationStatus+%3Fverif%3Bssn%3AobservationResultTime+%3Ffecha.%3Fres+ssn%3AhasValue%2Fdul%3AhasDataValue+%3Fvalor.+filter++%28%3Ffecha%3E%3D%222021-10-02T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+%3Ffecha%3C%222021-10-03T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+regex%28%3Furi%2C+%22horaria%22%29+and+%3Festacion%3D%3Chttp%3A%2F%2Fwww.zaragoza.es%2Fapi%2Frecurso%2Fmedio-ambiente%2Fcalidad-aire%2Festacion%2F40%3E+and+%3Fmagnitud%3D%3Chttp%3A%2F%2Fes.dbpedia.org%2Fresource%2FDi%25C3%25B3xido_de_nitr%25C3%25B3geno%3E%29%7Dorder+by+%3Fmagnitud+%3Festacion+%3Ffecha&format=application%2Fsparql-results%2Bjson&timeout=0&debug=on'
url_avdaSoria_so2 = 'http://datos.zaragoza.es/sparql?default-graph-uri=&query=PREFIX+ssn%3A%3Chttp%3A%2F%2Fpurl.oclc.org%2FNET%2Fssnx%2Fssn%23%3EPREFIX+dul%3A%3Chttp%3A%2F%2Fwww.loa-cnr.it%2Fontologies%2FDUL.owl%23%3EPREFIX+ssnext%3A%3Chttp%3A%2F%2Fvocab.linkeddata.es%2Fdatosabiertos%2Fdef%2Fmedio-ambiente%2Fcalidad-aire%2Fssn-ext%23%3Eselect+distinct+%3Fmagnitud+%3Festacion+%3Ffecha+%3Fvalor+%3Fverif+where+%7B%3Furi+a+ssn%3AObservation%3Bssn%3AobservedBy+%3Festacion%3Bssn%3AobservationResult+%3Fres%3Bssn%3AobservedProperty+%3Fmagnitud%3Bssnext%3AobservationStatus+%3Fverif%3Bssn%3AobservationResultTime+%3Ffecha.%3Fres+ssn%3AhasValue%2Fdul%3AhasDataValue+%3Fvalor.+filter++%28%3Ffecha%3E%3D%222021-10-02T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+%3Ffecha%3C%222021-10-03T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+regex%28%3Furi%2C+%22horaria%22%29+and+%3Festacion%3D%3Chttp%3A%2F%2Fwww.zaragoza.es%2Fapi%2Frecurso%2Fmedio-ambiente%2Fcalidad-aire%2Festacion%2F39%3E+and+%3Fmagnitud%3D%3Chttp%3A%2F%2Fes.dbpedia.org%2Fresource%2FDi%25C3%25B3xido_de_azufre%3E%29%7Dorder+by+%3Fmagnitud+%3Festacion+%3Ffecha&format=application%2Fsparql-results%2Bjson&timeout=0&debug=on'
url_avdaSoria_no2 = 'http://datos.zaragoza.es/sparql?default-graph-uri=&query=PREFIX+ssn%3A%3Chttp%3A%2F%2Fpurl.oclc.org%2FNET%2Fssnx%2Fssn%23%3EPREFIX+dul%3A%3Chttp%3A%2F%2Fwww.loa-cnr.it%2Fontologies%2FDUL.owl%23%3EPREFIX+ssnext%3A%3Chttp%3A%2F%2Fvocab.linkeddata.es%2Fdatosabiertos%2Fdef%2Fmedio-ambiente%2Fcalidad-aire%2Fssn-ext%23%3Eselect+distinct+%3Fmagnitud+%3Festacion+%3Ffecha+%3Fvalor+%3Fverif+where+%7B%3Furi+a+ssn%3AObservation%3Bssn%3AobservedBy+%3Festacion%3Bssn%3AobservationResult+%3Fres%3Bssn%3AobservedProperty+%3Fmagnitud%3Bssnext%3AobservationStatus+%3Fverif%3Bssn%3AobservationResultTime+%3Ffecha.%3Fres+ssn%3AhasValue%2Fdul%3AhasDataValue+%3Fvalor.+filter++%28%3Ffecha%3E%3D%222021-10-02T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+%3Ffecha%3C%222021-10-03T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+regex%28%3Furi%2C+%22horaria%22%29+and+%3Festacion%3D%3Chttp%3A%2F%2Fwww.zaragoza.es%2Fapi%2Frecurso%2Fmedio-ambiente%2Fcalidad-aire%2Festacion%2F39%3E+and+%3Fmagnitud%3D%3Chttp%3A%2F%2Fes.dbpedia.org%2Fresource%2FDi%25C3%25B3xido_de_nitr%25C3%25B3geno%3E%29%7Dorder+by+%3Fmagnitud+%3Festacion+%3Ffecha&format=application%2Fsparql-results%2Bjson&timeout=0&debug=on'
url_avdaSoria_co = 'http://datos.zaragoza.es/sparql?default-graph-uri=&query=PREFIX+ssn%3A%3Chttp%3A%2F%2Fpurl.oclc.org%2FNET%2Fssnx%2Fssn%23%3EPREFIX+dul%3A%3Chttp%3A%2F%2Fwww.loa-cnr.it%2Fontologies%2FDUL.owl%23%3EPREFIX+ssnext%3A%3Chttp%3A%2F%2Fvocab.linkeddata.es%2Fdatosabiertos%2Fdef%2Fmedio-ambiente%2Fcalidad-aire%2Fssn-ext%23%3Eselect+distinct+%3Fmagnitud+%3Festacion+%3Ffecha+%3Fvalor+%3Fverif+where+%7B%3Furi+a+ssn%3AObservation%3Bssn%3AobservedBy+%3Festacion%3Bssn%3AobservationResult+%3Fres%3Bssn%3AobservedProperty+%3Fmagnitud%3Bssnext%3AobservationStatus+%3Fverif%3Bssn%3AobservationResultTime+%3Ffecha.%3Fres+ssn%3AhasValue%2Fdul%3AhasDataValue+%3Fvalor.+filter++%28%3Ffecha%3E%3D%222021-10-02T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+%3Ffecha%3C%222021-10-03T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+regex%28%3Furi%2C+%22horaria%22%29+and+%3Festacion%3D%3Chttp%3A%2F%2Fwww.zaragoza.es%2Fapi%2Frecurso%2Fmedio-ambiente%2Fcalidad-aire%2Festacion%2F39%3E+and+%3Fmagnitud%3D%3Chttp%3A%2F%2Fes.dbpedia.org%2Fresource%2FMon%25C3%25B3xido_de_carbono%3E%29%7Dorder+by+%3Fmagnitud+%3Festacion+%3Ffecha&format=application%2Fsparql-results%2Bjson&timeout=0&debug=on'
url_lasFuentes_so2 = 'http://datos.zaragoza.es/sparql?default-graph-uri=&query=PREFIX+ssn%3A%3Chttp%3A%2F%2Fpurl.oclc.org%2FNET%2Fssnx%2Fssn%23%3EPREFIX+dul%3A%3Chttp%3A%2F%2Fwww.loa-cnr.it%2Fontologies%2FDUL.owl%23%3EPREFIX+ssnext%3A%3Chttp%3A%2F%2Fvocab.linkeddata.es%2Fdatosabiertos%2Fdef%2Fmedio-ambiente%2Fcalidad-aire%2Fssn-ext%23%3Eselect+distinct+%3Fmagnitud+%3Festacion+%3Ffecha+%3Fvalor+%3Fverif+where+%7B%3Furi+a+ssn%3AObservation%3Bssn%3AobservedBy+%3Festacion%3Bssn%3AobservationResult+%3Fres%3Bssn%3AobservedProperty+%3Fmagnitud%3Bssnext%3AobservationStatus+%3Fverif%3Bssn%3AobservationResultTime+%3Ffecha.%3Fres+ssn%3AhasValue%2Fdul%3AhasDataValue+%3Fvalor.+filter++%28%3Ffecha%3E%3D%222021-10-02T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+%3Ffecha%3C%222021-10-03T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+regex%28%3Furi%2C+%22horaria%22%29+and+%3Festacion%3D%3Chttp%3A%2F%2Fwww.zaragoza.es%2Fapi%2Frecurso%2Fmedio-ambiente%2Fcalidad-aire%2Festacion%2F37%3E+and+%3Fmagnitud%3D%3Chttp%3A%2F%2Fes.dbpedia.org%2Fresource%2FDi%25C3%25B3xido_de_azufre%3E%29%7Dorder+by+%3Fmagnitud+%3Festacion+%3Ffecha&format=application%2Fsparql-results%2Bjson&timeout=0&debug=on'
url_lasFuentes_no2 = 'http://datos.zaragoza.es/sparql?default-graph-uri=&query=PREFIX+ssn%3A%3Chttp%3A%2F%2Fpurl.oclc.org%2FNET%2Fssnx%2Fssn%23%3EPREFIX+dul%3A%3Chttp%3A%2F%2Fwww.loa-cnr.it%2Fontologies%2FDUL.owl%23%3EPREFIX+ssnext%3A%3Chttp%3A%2F%2Fvocab.linkeddata.es%2Fdatosabiertos%2Fdef%2Fmedio-ambiente%2Fcalidad-aire%2Fssn-ext%23%3Eselect+distinct+%3Fmagnitud+%3Festacion+%3Ffecha+%3Fvalor+%3Fverif+where+%7B%3Furi+a+ssn%3AObservation%3Bssn%3AobservedBy+%3Festacion%3Bssn%3AobservationResult+%3Fres%3Bssn%3AobservedProperty+%3Fmagnitud%3Bssnext%3AobservationStatus+%3Fverif%3Bssn%3AobservationResultTime+%3Ffecha.%3Fres+ssn%3AhasValue%2Fdul%3AhasDataValue+%3Fvalor.+filter++%28%3Ffecha%3E%3D%222021-10-02T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+%3Ffecha%3C%222021-10-03T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+regex%28%3Furi%2C+%22horaria%22%29+and+%3Festacion%3D%3Chttp%3A%2F%2Fwww.zaragoza.es%2Fapi%2Frecurso%2Fmedio-ambiente%2Fcalidad-aire%2Festacion%2F37%3E+and+%3Fmagnitud%3D%3Chttp%3A%2F%2Fes.dbpedia.org%2Fresource%2FDi%25C3%25B3xido_de_nitr%25C3%25B3geno%3E%29%7Dorder+by+%3Fmagnitud+%3Festacion+%3Ffecha&format=application%2Fsparql-results%2Bjson&timeout=0&debug=on'
url_lasFuentes_co = 'http://datos.zaragoza.es/sparql?default-graph-uri=&query=PREFIX+ssn%3A%3Chttp%3A%2F%2Fpurl.oclc.org%2FNET%2Fssnx%2Fssn%23%3EPREFIX+dul%3A%3Chttp%3A%2F%2Fwww.loa-cnr.it%2Fontologies%2FDUL.owl%23%3EPREFIX+ssnext%3A%3Chttp%3A%2F%2Fvocab.linkeddata.es%2Fdatosabiertos%2Fdef%2Fmedio-ambiente%2Fcalidad-aire%2Fssn-ext%23%3Eselect+distinct+%3Fmagnitud+%3Festacion+%3Ffecha+%3Fvalor+%3Fverif+where+%7B%3Furi+a+ssn%3AObservation%3Bssn%3AobservedBy+%3Festacion%3Bssn%3AobservationResult+%3Fres%3Bssn%3AobservedProperty+%3Fmagnitud%3Bssnext%3AobservationStatus+%3Fverif%3Bssn%3AobservationResultTime+%3Ffecha.%3Fres+ssn%3AhasValue%2Fdul%3AhasDataValue+%3Fvalor.+filter++%28%3Ffecha%3E%3D%222021-10-02T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+%3Ffecha%3C%222021-10-03T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+regex%28%3Furi%2C+%22horaria%22%29+and+%3Festacion%3D%3Chttp%3A%2F%2Fwww.zaragoza.es%2Fapi%2Frecurso%2Fmedio-ambiente%2Fcalidad-aire%2Festacion%2F37%3E+and+%3Fmagnitud%3D%3Chttp%3A%2F%2Fes.dbpedia.org%2Fresource%2FMon%25C3%25B3xido_de_carbono%3E%29%7Dorder+by+%3Fmagnitud+%3Festacion+%3Ffecha&format=application%2Fsparql-results%2Bjson&timeout=0&debug=on'
url_renovables_so2 = 'http://datos.zaragoza.es/sparql?default-graph-uri=&query=PREFIX+ssn%3A%3Chttp%3A%2F%2Fpurl.oclc.org%2FNET%2Fssnx%2Fssn%23%3EPREFIX+dul%3A%3Chttp%3A%2F%2Fwww.loa-cnr.it%2Fontologies%2FDUL.owl%23%3EPREFIX+ssnext%3A%3Chttp%3A%2F%2Fvocab.linkeddata.es%2Fdatosabiertos%2Fdef%2Fmedio-ambiente%2Fcalidad-aire%2Fssn-ext%23%3Eselect+distinct+%3Fmagnitud+%3Festacion+%3Ffecha+%3Fvalor+%3Fverif+where+%7B%3Furi+a+ssn%3AObservation%3Bssn%3AobservedBy+%3Festacion%3Bssn%3AobservationResult+%3Fres%3Bssn%3AobservedProperty+%3Fmagnitud%3Bssnext%3AobservationStatus+%3Fverif%3Bssn%3AobservationResultTime+%3Ffecha.%3Fres+ssn%3AhasValue%2Fdul%3AhasDataValue+%3Fvalor.+filter++%28%3Ffecha%3E%3D%222021-10-02T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+%3Ffecha%3C%222021-10-03T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+regex%28%3Furi%2C+%22horaria%22%29+and+%3Festacion%3D%3Chttp%3A%2F%2Fwww.zaragoza.es%2Fapi%2Frecurso%2Fmedio-ambiente%2Fcalidad-aire%2Festacion%2F36%3E+and+%3Fmagnitud%3D%3Chttp%3A%2F%2Fes.dbpedia.org%2Fresource%2FDi%25C3%25B3xido_de_azufre%3E%29%7Dorder+by+%3Fmagnitud+%3Festacion+%3Ffecha&format=application%2Fsparql-results%2Bjson&timeout=0&debug=on'
url_renovables_no2 = 'http://datos.zaragoza.es/sparql?default-graph-uri=&query=PREFIX+ssn%3A%3Chttp%3A%2F%2Fpurl.oclc.org%2FNET%2Fssnx%2Fssn%23%3EPREFIX+dul%3A%3Chttp%3A%2F%2Fwww.loa-cnr.it%2Fontologies%2FDUL.owl%23%3EPREFIX+ssnext%3A%3Chttp%3A%2F%2Fvocab.linkeddata.es%2Fdatosabiertos%2Fdef%2Fmedio-ambiente%2Fcalidad-aire%2Fssn-ext%23%3Eselect+distinct+%3Fmagnitud+%3Festacion+%3Ffecha+%3Fvalor+%3Fverif+where+%7B%3Furi+a+ssn%3AObservation%3Bssn%3AobservedBy+%3Festacion%3Bssn%3AobservationResult+%3Fres%3Bssn%3AobservedProperty+%3Fmagnitud%3Bssnext%3AobservationStatus+%3Fverif%3Bssn%3AobservationResultTime+%3Ffecha.%3Fres+ssn%3AhasValue%2Fdul%3AhasDataValue+%3Fvalor.+filter++%28%3Ffecha%3E%3D%222021-10-02T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+%3Ffecha%3C%222021-10-03T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+regex%28%3Furi%2C+%22horaria%22%29+and+%3Festacion%3D%3Chttp%3A%2F%2Fwww.zaragoza.es%2Fapi%2Frecurso%2Fmedio-ambiente%2Fcalidad-aire%2Festacion%2F36%3E+and+%3Fmagnitud%3D%3Chttp%3A%2F%2Fes.dbpedia.org%2Fresource%2FDi%25C3%25B3xido_de_nitr%25C3%25B3geno%3E%29%7Dorder+by+%3Fmagnitud+%3Festacion+%3Ffecha&format=application%2Fsparql-results%2Bjson&timeout=0&debug=on'
url_renovables_co = 'http://datos.zaragoza.es/sparql?default-graph-uri=&query=PREFIX+ssn%3A%3Chttp%3A%2F%2Fpurl.oclc.org%2FNET%2Fssnx%2Fssn%23%3EPREFIX+dul%3A%3Chttp%3A%2F%2Fwww.loa-cnr.it%2Fontologies%2FDUL.owl%23%3EPREFIX+ssnext%3A%3Chttp%3A%2F%2Fvocab.linkeddata.es%2Fdatosabiertos%2Fdef%2Fmedio-ambiente%2Fcalidad-aire%2Fssn-ext%23%3Eselect+distinct+%3Fmagnitud+%3Festacion+%3Ffecha+%3Fvalor+%3Fverif+where+%7B%3Furi+a+ssn%3AObservation%3Bssn%3AobservedBy+%3Festacion%3Bssn%3AobservationResult+%3Fres%3Bssn%3AobservedProperty+%3Fmagnitud%3Bssnext%3AobservationStatus+%3Fverif%3Bssn%3AobservationResultTime+%3Ffecha.%3Fres+ssn%3AhasValue%2Fdul%3AhasDataValue+%3Fvalor.+filter++%28%3Ffecha%3E%3D%222021-10-02T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+%3Ffecha%3C%222021-10-03T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+regex%28%3Furi%2C+%22horaria%22%29+and+%3Festacion%3D%3Chttp%3A%2F%2Fwww.zaragoza.es%2Fapi%2Frecurso%2Fmedio-ambiente%2Fcalidad-aire%2Festacion%2F36%3E+and+%3Fmagnitud%3D%3Chttp%3A%2F%2Fes.dbpedia.org%2Fresource%2FMon%25C3%25B3xido_de_carbono%3E%29%7Dorder+by+%3Fmagnitud+%3Festacion+%3Ffecha&format=application%2Fsparql-results%2Bjson&timeout=0&debug=on'
url_jaime_so2 = 'http://datos.zaragoza.es/sparql?default-graph-uri=&query=PREFIX+ssn%3A%3Chttp%3A%2F%2Fpurl.oclc.org%2FNET%2Fssnx%2Fssn%23%3EPREFIX+dul%3A%3Chttp%3A%2F%2Fwww.loa-cnr.it%2Fontologies%2FDUL.owl%23%3EPREFIX+ssnext%3A%3Chttp%3A%2F%2Fvocab.linkeddata.es%2Fdatosabiertos%2Fdef%2Fmedio-ambiente%2Fcalidad-aire%2Fssn-ext%23%3Eselect+distinct+%3Fmagnitud+%3Festacion+%3Ffecha+%3Fvalor+%3Fverif+where+%7B%3Furi+a+ssn%3AObservation%3Bssn%3AobservedBy+%3Festacion%3Bssn%3AobservationResult+%3Fres%3Bssn%3AobservedProperty+%3Fmagnitud%3Bssnext%3AobservationStatus+%3Fverif%3Bssn%3AobservationResultTime+%3Ffecha.%3Fres+ssn%3AhasValue%2Fdul%3AhasDataValue+%3Fvalor.+filter++%28%3Ffecha%3E%3D%222021-10-02T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+%3Ffecha%3C%222021-10-03T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+regex%28%3Furi%2C+%22horaria%22%29+and+%3Festacion%3D%3Chttp%3A%2F%2Fwww.zaragoza.es%2Fapi%2Frecurso%2Fmedio-ambiente%2Fcalidad-aire%2Festacion%2F32%3E+and+%3Fmagnitud%3D%3Chttp%3A%2F%2Fes.dbpedia.org%2Fresource%2FDi%25C3%25B3xido_de_azufre%3E%29%7Dorder+by+%3Fmagnitud+%3Festacion+%3Ffecha&format=application%2Fsparql-results%2Bjson&timeout=0&debug=on'
url_jaime_no2 = 'http://datos.zaragoza.es/sparql?default-graph-uri=&query=PREFIX+ssn%3A%3Chttp%3A%2F%2Fpurl.oclc.org%2FNET%2Fssnx%2Fssn%23%3EPREFIX+dul%3A%3Chttp%3A%2F%2Fwww.loa-cnr.it%2Fontologies%2FDUL.owl%23%3EPREFIX+ssnext%3A%3Chttp%3A%2F%2Fvocab.linkeddata.es%2Fdatosabiertos%2Fdef%2Fmedio-ambiente%2Fcalidad-aire%2Fssn-ext%23%3Eselect+distinct+%3Fmagnitud+%3Festacion+%3Ffecha+%3Fvalor+%3Fverif+where+%7B%3Furi+a+ssn%3AObservation%3Bssn%3AobservedBy+%3Festacion%3Bssn%3AobservationResult+%3Fres%3Bssn%3AobservedProperty+%3Fmagnitud%3Bssnext%3AobservationStatus+%3Fverif%3Bssn%3AobservationResultTime+%3Ffecha.%3Fres+ssn%3AhasValue%2Fdul%3AhasDataValue+%3Fvalor.+filter++%28%3Ffecha%3E%3D%222021-10-02T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+%3Ffecha%3C%222021-10-03T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+regex%28%3Furi%2C+%22horaria%22%29+and+%3Festacion%3D%3Chttp%3A%2F%2Fwww.zaragoza.es%2Fapi%2Frecurso%2Fmedio-ambiente%2Fcalidad-aire%2Festacion%2F32%3E+and+%3Fmagnitud%3D%3Chttp%3A%2F%2Fes.dbpedia.org%2Fresource%2FDi%25C3%25B3xido_de_nitr%25C3%25B3geno%3E%29%7Dorder+by+%3Fmagnitud+%3Festacion+%3Ffecha&format=application%2Fsparql-results%2Bjson&timeout=0&debug=on'
url_jaime_co = 'http://datos.zaragoza.es/sparql?default-graph-uri=&query=PREFIX+ssn%3A%3Chttp%3A%2F%2Fpurl.oclc.org%2FNET%2Fssnx%2Fssn%23%3EPREFIX+dul%3A%3Chttp%3A%2F%2Fwww.loa-cnr.it%2Fontologies%2FDUL.owl%23%3EPREFIX+ssnext%3A%3Chttp%3A%2F%2Fvocab.linkeddata.es%2Fdatosabiertos%2Fdef%2Fmedio-ambiente%2Fcalidad-aire%2Fssn-ext%23%3Eselect+distinct+%3Fmagnitud+%3Festacion+%3Ffecha+%3Fvalor+%3Fverif+where+%7B%3Furi+a+ssn%3AObservation%3Bssn%3AobservedBy+%3Festacion%3Bssn%3AobservationResult+%3Fres%3Bssn%3AobservedProperty+%3Fmagnitud%3Bssnext%3AobservationStatus+%3Fverif%3Bssn%3AobservationResultTime+%3Ffecha.%3Fres+ssn%3AhasValue%2Fdul%3AhasDataValue+%3Fvalor.+filter++%28%3Ffecha%3E%3D%222021-10-02T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+%3Ffecha%3C%222021-10-03T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+regex%28%3Furi%2C+%22horaria%22%29+and+%3Festacion%3D%3Chttp%3A%2F%2Fwww.zaragoza.es%2Fapi%2Frecurso%2Fmedio-ambiente%2Fcalidad-aire%2Festacion%2F32%3E+and+%3Fmagnitud%3D%3Chttp%3A%2F%2Fes.dbpedia.org%2Fresource%2FMon%25C3%25B3xido_de_carbono%3E%29%7Dorder+by+%3Fmagnitud+%3Festacion+%3Ffecha&format=application%2Fsparql-results%2Bjson&timeout=0&debug=on'
url_roger_so2 = 'http://datos.zaragoza.es/sparql?default-graph-uri=&query=PREFIX+ssn%3A%3Chttp%3A%2F%2Fpurl.oclc.org%2FNET%2Fssnx%2Fssn%23%3EPREFIX+dul%3A%3Chttp%3A%2F%2Fwww.loa-cnr.it%2Fontologies%2FDUL.owl%23%3EPREFIX+ssnext%3A%3Chttp%3A%2F%2Fvocab.linkeddata.es%2Fdatosabiertos%2Fdef%2Fmedio-ambiente%2Fcalidad-aire%2Fssn-ext%23%3Eselect+distinct+%3Fmagnitud+%3Festacion+%3Ffecha+%3Fvalor+%3Fverif+where+%7B%3Furi+a+ssn%3AObservation%3Bssn%3AobservedBy+%3Festacion%3Bssn%3AobservationResult+%3Fres%3Bssn%3AobservedProperty+%3Fmagnitud%3Bssnext%3AobservationStatus+%3Fverif%3Bssn%3AobservationResultTime+%3Ffecha.%3Fres+ssn%3AhasValue%2Fdul%3AhasDataValue+%3Fvalor.+filter++%28%3Ffecha%3E%3D%222021-10-02T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+%3Ffecha%3C%222021-10-03T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+regex%28%3Furi%2C+%22horaria%22%29+and+%3Festacion%3D%3Chttp%3A%2F%2Fwww.zaragoza.es%2Fapi%2Frecurso%2Fmedio-ambiente%2Fcalidad-aire%2Festacion%2F29%3E+and+%3Fmagnitud%3D%3Chttp%3A%2F%2Fes.dbpedia.org%2Fresource%2FDi%25C3%25B3xido_de_azufre%3E%29%7Dorder+by+%3Fmagnitud+%3Festacion+%3Ffecha&format=application%2Fsparql-results%2Bjson&timeout=0&debug=on'
url_roger_no2 = 'http://datos.zaragoza.es/sparql?default-graph-uri=&query=PREFIX+ssn%3A%3Chttp%3A%2F%2Fpurl.oclc.org%2FNET%2Fssnx%2Fssn%23%3EPREFIX+dul%3A%3Chttp%3A%2F%2Fwww.loa-cnr.it%2Fontologies%2FDUL.owl%23%3EPREFIX+ssnext%3A%3Chttp%3A%2F%2Fvocab.linkeddata.es%2Fdatosabiertos%2Fdef%2Fmedio-ambiente%2Fcalidad-aire%2Fssn-ext%23%3Eselect+distinct+%3Fmagnitud+%3Festacion+%3Ffecha+%3Fvalor+%3Fverif+where+%7B%3Furi+a+ssn%3AObservation%3Bssn%3AobservedBy+%3Festacion%3Bssn%3AobservationResult+%3Fres%3Bssn%3AobservedProperty+%3Fmagnitud%3Bssnext%3AobservationStatus+%3Fverif%3Bssn%3AobservationResultTime+%3Ffecha.%3Fres+ssn%3AhasValue%2Fdul%3AhasDataValue+%3Fvalor.+filter++%28%3Ffecha%3E%3D%222021-10-02T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+%3Ffecha%3C%222021-10-03T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+regex%28%3Furi%2C+%22horaria%22%29+and+%3Festacion%3D%3Chttp%3A%2F%2Fwww.zaragoza.es%2Fapi%2Frecurso%2Fmedio-ambiente%2Fcalidad-aire%2Festacion%2F29%3E+and+%3Fmagnitud%3D%3Chttp%3A%2F%2Fes.dbpedia.org%2Fresource%2FDi%25C3%25B3xido_de_nitr%25C3%25B3geno%3E%29%7Dorder+by+%3Fmagnitud+%3Festacion+%3Ffecha&format=application%2Fsparql-results%2Bjson&timeout=0&debug=on'
url_roger_co = 'http://datos.zaragoza.es/sparql?default-graph-uri=&query=PREFIX+ssn%3A%3Chttp%3A%2F%2Fpurl.oclc.org%2FNET%2Fssnx%2Fssn%23%3EPREFIX+dul%3A%3Chttp%3A%2F%2Fwww.loa-cnr.it%2Fontologies%2FDUL.owl%23%3EPREFIX+ssnext%3A%3Chttp%3A%2F%2Fvocab.linkeddata.es%2Fdatosabiertos%2Fdef%2Fmedio-ambiente%2Fcalidad-aire%2Fssn-ext%23%3Eselect+distinct+%3Fmagnitud+%3Festacion+%3Ffecha+%3Fvalor+%3Fverif+where+%7B%3Furi+a+ssn%3AObservation%3Bssn%3AobservedBy+%3Festacion%3Bssn%3AobservationResult+%3Fres%3Bssn%3AobservedProperty+%3Fmagnitud%3Bssnext%3AobservationStatus+%3Fverif%3Bssn%3AobservationResultTime+%3Ffecha.%3Fres+ssn%3AhasValue%2Fdul%3AhasDataValue+%3Fvalor.+filter++%28%3Ffecha%3E%3D%222021-10-02T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+%3Ffecha%3C%222021-10-03T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+regex%28%3Furi%2C+%22horaria%22%29+and+%3Festacion%3D%3Chttp%3A%2F%2Fwww.zaragoza.es%2Fapi%2Frecurso%2Fmedio-ambiente%2Fcalidad-aire%2Festacion%2F29%3E+and+%3Fmagnitud%3D%3Chttp%3A%2F%2Fes.dbpedia.org%2Fresource%2FMon%25C3%25B3xido_de_carbono%3E%29%7Dorder+by+%3Fmagnitud+%3Festacion+%3Ffecha&format=application%2Fsparql-results%2Bjson&timeout=0&debug=on'
url_picarral_no2 = 'http://datos.zaragoza.es/sparql?default-graph-uri=&query=PREFIX+ssn%3A%3Chttp%3A%2F%2Fpurl.oclc.org%2FNET%2Fssnx%2Fssn%23%3EPREFIX+dul%3A%3Chttp%3A%2F%2Fwww.loa-cnr.it%2Fontologies%2FDUL.owl%23%3EPREFIX+ssnext%3A%3Chttp%3A%2F%2Fvocab.linkeddata.es%2Fdatosabiertos%2Fdef%2Fmedio-ambiente%2Fcalidad-aire%2Fssn-ext%23%3Eselect+distinct+%3Fmagnitud+%3Festacion+%3Ffecha+%3Fvalor+%3Fverif+where+%7B%3Furi+a+ssn%3AObservation%3Bssn%3AobservedBy+%3Festacion%3Bssn%3AobservationResult+%3Fres%3Bssn%3AobservedProperty+%3Fmagnitud%3Bssnext%3AobservationStatus+%3Fverif%3Bssn%3AobservationResultTime+%3Ffecha.%3Fres+ssn%3AhasValue%2Fdul%3AhasDataValue+%3Fvalor.+filter++%28%3Ffecha%3E%3D%222021-10-02T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+%3Ffecha%3C%222021-10-03T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+regex%28%3Furi%2C+%22horaria%22%29+and+%3Festacion%3D%3Chttp%3A%2F%2Fwww.zaragoza.es%2Fapi%2Frecurso%2Fmedio-ambiente%2Fcalidad-aire%2Festacion%2F26%3E+and+%3Fmagnitud%3D%3Chttp%3A%2F%2Fes.dbpedia.org%2Fresource%2FDi%25C3%25B3xido_de_nitr%25C3%25B3geno%3E%29%7Dorder+by+%3Fmagnitud+%3Festacion+%3Ffecha&format=application%2Fsparql-results%2Bjson&timeout=0&debug=on'
url_picarral_co = 'http://datos.zaragoza.es/sparql?default-graph-uri=&query=PREFIX+ssn%3A%3Chttp%3A%2F%2Fpurl.oclc.org%2FNET%2Fssnx%2Fssn%23%3EPREFIX+dul%3A%3Chttp%3A%2F%2Fwww.loa-cnr.it%2Fontologies%2FDUL.owl%23%3EPREFIX+ssnext%3A%3Chttp%3A%2F%2Fvocab.linkeddata.es%2Fdatosabiertos%2Fdef%2Fmedio-ambiente%2Fcalidad-aire%2Fssn-ext%23%3Eselect+distinct+%3Fmagnitud+%3Festacion+%3Ffecha+%3Fvalor+%3Fverif+where+%7B%3Furi+a+ssn%3AObservation%3Bssn%3AobservedBy+%3Festacion%3Bssn%3AobservationResult+%3Fres%3Bssn%3AobservedProperty+%3Fmagnitud%3Bssnext%3AobservationStatus+%3Fverif%3Bssn%3AobservationResultTime+%3Ffecha.%3Fres+ssn%3AhasValue%2Fdul%3AhasDataValue+%3Fvalor.+filter++%28%3Ffecha%3E%3D%222021-10-02T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+%3Ffecha%3C%222021-10-03T00%3A00%3A00Z%22%5E%5Exsd%3AdateTime+and+regex%28%3Furi%2C+%22horaria%22%29+and+%3Festacion%3D%3Chttp%3A%2F%2Fwww.zaragoza.es%2Fapi%2Frecurso%2Fmedio-ambiente%2Fcalidad-aire%2Festacion%2F26%3E+and+%3Fmagnitud%3D%3Chttp%3A%2F%2Fes.dbpedia.org%2Fresource%2FMon%25C3%25B3xido_de_carbono%3E%29%7Dorder+by+%3Fmagnitud+%3Festacion+%3Ffecha&format=application%2Fsparql-results%2Bjson&timeout=0&debug=on'



risk_factors = {'SO2 actur': '',
                'NO2 actur': url_actur_no2,
                'CO actur': '',
                'SO2 avda soria': url_avdaSoria_so2,
                'NO2 avda soria': url_avdaSoria_no2,
                'CO avda soria': url_avdaSoria_co,
                'SO2 centro': url_centro_so2,
                'NO2 centro': url_centro_no2,
                'CO centro': url_centro_co,
                'SO2 las fuentes': url_lasFuentes_so2,
                'NO2 las fuentes': url_lasFuentes_no2,
                'CO las fuentes': url_lasFuentes_co,
                'SO2 Renovables': url_renovables_so2,
                'NO2 Renovables': url_renovables_no2,
                'CO Renovables': url_renovables_co,
                'SO2 Jaime Ferrán': url_jaime_so2,
                'NO2 Jaime Ferrán': url_jaime_no2,
                'CO Jaime Ferrán': url_jaime_co,
                'SO2 Roger de Flor': url_roger_so2,
                'NO2 Roger de Flor': url_roger_no2,
                'CO Roger de Flor': url_roger_co,
                'SO2 El Picarral': '',
                'NO2 El Picarral': url_picarral_no2,
                'CO El Picarral': url_picarral_co}
values = []
# Iterate the dictionary
for key in risk_factors:
    if risk_factors[key]:
        with urllib.request.urlopen(risk_factors.get(key)) as url:
            data = json.loads(url.read().decode())
            bindings = data['results']['bindings']
            last_binding = bindings[len(bindings) - 1]
            value = last_binding['valor']['value']
            values.append(value)
            print(key + ': ' + value)
    else:
        values.append(0)
f=open("datos.txt","w")
for i in range (len(risk_factors)):
    f.write(f"{values[i]} ")
f.close()